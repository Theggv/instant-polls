import {
  GetServerSideProps,
  InferGetServerSidePropsType,
  NextPage,
} from 'next';
import Head from 'next/head';
import React from 'react';

import Layout from '../../../common/containers/Layout';
import { PollResults, PollResultsProps } from '../../../features/PollResults';
import { getResults } from '../../api/polls/results';

export const getServerSideProps: GetServerSideProps<PollResultsProps> = async ({
  params,
}) => {
  const id = params?.id as string;
  const data = await getResults(id);

  if (!data) return { notFound: true };

  return {
    props: { ...data, id },
  };
};

const Results: NextPage<
  InferGetServerSidePropsType<typeof getServerSideProps>
> = (props) => {
  return (
    <Layout>
      <Head>
        <title>{props.draft.title} | Results | Instant polls</title>
        <meta name='description' content='Generated by create next app' />
      </Head>
      <PollResults {...props} />
    </Layout>
  );
};

export default Results;
